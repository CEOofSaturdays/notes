# Voice Call Integration Status Report
**Date:** 2026-02-18
**Status:** ⚠️ On Hold (Blocked by Media Stream Routing)

## Objective
Establish a two-way voice integration for "Alfred" using **Twilio** (telephony), **OpenAI/ElevenLabs** (TTS), and **Tailscale Funnel** (public ingress).

## Progress Made
- **Plugin Enabled:** `voice-call` plugin is active and configured in `openclaw.json`.
- **Credentials:** Twilio SID, Auth Token, and API Keys are securely stored in `secrets.env`.
- **Ingress:** Tailscale Funnel is active at `https://matthews-mac-mini.folk-pound.ts.net`.
- **Partial Success:** "Notify" mode (one-way TwiML speech) is fully functional. The gateway successfully receives webhooks and Twilio can play back the provider's native voice.

## Current Blockers
- **Conversation Mode Failure:** Initiating a `conversation` call results in an immediate "Application Error" from Twilio once the call is answered.
- **WebSocket Handshake:** Real-time audio streaming (Twilio Media Streams) requires a stable WebSocket connection. Twilio's monitor logs report **404 (Not Found)** or **502 (Bad Gateway)** when attempting to "upgrade" the connection to a stream.
- **Funnel Routing:** Tailscale Funnel appears to be dropping or misrouting the binary WebSocket traffic required for the `streamPath`. We attempted multiple path configurations (root `/` vs `/voice/webhook`), but the handshake still fails.

## Attempted Fixes
1. **TTS Swap:** Tried both ElevenLabs (Brian/Roger) and OpenAI (Onyx) to rule out TTS latency.
2. **Path Flattening:** Reconfigured the plugin to listen on the root path to simplify proxy logic.
3. **Region Pinning:** Attempted routing via Twilio's **AU1** region to reduce latency.
4. **Security Tweak:** Temporarily disabled `skipSignatureVerification` to rule out auth-header mismatches in the tunnel.

## Recommendations for Resume
- **Infrastructure Investigation:** Verify Tailscale Funnel's specific handling of WebSocket "Upgrade" headers. 
- **Alternative Ingress:** Consider testing with a **Cloudflare Tunnel** or a dedicated **Nginx** proxy if Tailscale Funnel remains inconsistent for binary streams.
- **Log Deep Dive:** Review internal `voice-call` plugin logs specifically during the `MediaStream` transition.

---
*Report generated by Alfred.*
